<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>×”×ª×§× ×ª OutlookLLM</title>
    <style>
        body { 
            font-family: Segoe UI, Arial, sans-serif; 
            margin: 40px; 
            background: #f5f5f5; 
            direction: rtl; 
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .step { 
            margin: 25px 0; 
            padding: 20px; 
            background: #f0f8ff; 
            border-right: 4px solid #0078d4; 
            border-radius: 5px;
        }
        .step h3 { color: #0078d4; margin-top: 0; }
        .button { 
            display: inline-block;
            padding: 12px 24px; 
            background: #0078d4; 
            color: white; 
            text-decoration: none; 
            border-radius: 5px; 
            margin: 5px; 
            border: none;
            cursor: pointer;
            font-size: 16px;
        }
        .button:hover { background: #106ebe; }
        .manifest-url { 
            background: #f8f8f8; 
            padding: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            font-family: monospace; 
            font-size: 14px;
            direction: ltr;
            text-align: left;
        }
        .success { color: #107c10; font-weight: bold; }
        .warning { color: #d13438; font-weight: bold; }
        .status { 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px; 
        }
        .status.ok { background: #d4edd6; border: 1px solid #107c10; }
        .status.error { background: #fde7e9; border: 1px solid #d13438; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ ×”×ª×§× ×ª OutlookLLM ×œ×ª×™×‘×ª ×”××™×™×œ×™×</h1>
        
        <div id="status-check">
            <h2>×‘×“×™×§×ª ××¢×¨×›×ª</h2>
            <button class="button" onclick="checkStatus()">×‘×“×•×§ ××¦×‘ ×”×©×¨×ª×™×</button>
            <div id="status-result"></div>
        </div>

        <div class="step">
            <h3>×©×œ×‘ 1: ×¤×ª×— ××ª Outlook Web</h3>
            <p>×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨ ×œ××˜×” ×›×“×™ ×œ×¤×ª×•×— ××ª Outlook Web:</p>
            <a href="https://outlook.live.com" target="_blank" class="button">×¤×ª×— Outlook Web</a>
        </div>

        <div class="step">
            <h3>×©×œ×‘ 2: × ×•×•×˜ ×œ×”×ª×§× ×ª ×ª×•×¡×¤×•×ª</h3>
            <p>×‘-Outlook Web:</p>
            <ol>
                <li>×”×ª×—×‘×¨ ×œ×—×©×‘×•×Ÿ ×©×œ×š</li>
                <li>×œ×—×¥ ×¢×œ âš™ï¸ (Settings) ×‘×¤×™× ×” ×”×™×× ×™×ª ×”×¢×œ×™×•× ×”</li>
                <li>×‘×—×¨ "View all Outlook settings"</li>
                <li>×œ×—×¥ ×¢×œ "General" ×•××– "Add-ins"</li>
                <li>××• ×œ×—×¥ ×›××Ÿ: <a href="https://outlook.live.com/mail/0/options/general/addins" target="_blank" class="button">×§×™×©×•×¨ ×™×©×™×¨ ×œ×ª×•×¡×¤×•×ª</a></li>
            </ol>
        </div>

        <div class="step">
            <h3>×©×œ×‘ 3: ×”×ª×§×Ÿ ××ª ×”×ª×•×¡×£</h3>
            <p>×‘×“×£ ×”×ª×•×¡×¤×•×ª:</p>
            <ol>
                <li>×œ×—×¥ ×¢×œ "My add-ins"</li>
                <li>×œ×—×¥ ×¢×œ "+ Add a custom add-in"</li>
                <li>×‘×—×¨ "Add from URL"</li>
                <li>×”×¢×ª×§ ×•×”×“×‘×§ ××ª ×”×›×ª×•×‘×ª ×”×‘××”:</li>
            </ol>
            <div class="manifest-url" id="manifest-url">https://localhost:3001/manifest.xml</div>
            <button class="button" onclick="copyManifest()">×”×¢×ª×§ ×›×ª×•×‘×ª</button>
            <button class="button" onclick="testManifest()">×‘×“×•×§ × ×’×™×©×•×ª</button>
        </div>

        <div class="step">
            <h3>×©×œ×‘ 4: ×”×©×ª××© ×‘×ª×•×¡×£</h3>
            <p>×œ××—×¨ ×”×”×ª×§× ×” ×”××•×¦×œ×—×ª:</p>
            <ol>
                <li>×¤×ª×— ××™×™×œ ×—×“×© ××• ×‘×—×¨ ××™×™×œ ×§×™×™×</li>
                <li>×—×¤×© ××ª "OutlookLLM" ×‘×¡×¨×’×œ ×”×›×œ×™×</li>
                <li>×”×©×ª××© ×‘×ª×›×•× ×•×ª ×”AI ×œ×¡×™×›×•× ×•××¢× ×” ×œ××™×™×œ×™×</li>
            </ol>
            <a href="https://localhost:3001/taskpane.html" target="_blank" class="button">×‘×“×•×§ ×××©×§</a>
        </div>

        <div class="step">
            <h3>ğŸ› ï¸ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª</h3>
            <button class="button" onclick="openTroubleshooting()">××“×¨×™×š ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª</button>
            <button class="button" onclick="openTestInterface()">×××©×§ ×‘×“×™×§×•×ª</button>
        </div>
    </div>

    <script>
        async function checkStatus() {
            const resultDiv = document.getElementById('status-result');
            resultDiv.innerHTML = '<p>×‘×•×“×§...</p>';
            
            let backendStatus = 'âŒ ×œ× ×¨×¥';
            let frontendStatus = 'âŒ ×œ× ×¨×¥';
            let manifestStatus = 'âŒ ×œ× × ×’×™×©';
            
            try {
                const backendResponse = await fetch('http://127.0.0.1:8385/health');
                if (backendResponse.ok) {
                    backendStatus = 'âœ… ×¨×¥ ×ª×§×™×Ÿ';
                }
            } catch (e) {
                console.log('Backend not running');
            }
            
            try {
                const frontendResponse = await fetch('https://localhost:3001/');
                if (frontendResponse.ok) {
                    frontendStatus = 'âœ… ×¨×¥ ×ª×§×™×Ÿ';
                }
            } catch (e) {
                console.log('Frontend not running');
            }
            
            try {
                const manifestResponse = await fetch('https://localhost:3001/manifest.xml');
                if (manifestResponse.ok) {
                    manifestStatus = 'âœ… × ×’×™×©';
                }
            } catch (e) {
                console.log('Manifest not accessible');
            }
            
            const allOk = backendStatus.includes('âœ…') && frontendStatus.includes('âœ…') && manifestStatus.includes('âœ…');
            
            resultDiv.innerHTML = `
                <div class="status ${allOk ? 'ok' : 'error'}">
                    <strong>××¦×‘ ×”×©×¨×ª×™×:</strong><br>
                    ğŸ–¥ï¸ ×©×¨×ª ×§×œ×¤×™ (Backend): ${backendStatus}<br>
                    ğŸŒ ×©×¨×ª ×××©×§ (Frontend): ${frontendStatus}<br>
                    ğŸ“„ ×§×•×‘×¥ Manifest: ${manifestStatus}<br>
                    ${allOk ? '<br><span class="success">âœ… ×”××¢×¨×›×ª ××•×›× ×” ×œ×”×ª×§× ×”!</span>' : '<br><span class="warning">âš ï¸ × × ×œ×”×¤×¢×™×œ ××ª ×”×©×¨×ª×™× ×ª×—×™×œ×”</span>'}
                </div>
            `;
        }
        
        function copyManifest() {
            const manifestUrl = document.getElementById('manifest-url').textContent;
            navigator.clipboard.writeText(manifestUrl).then(function() {
                alert('×”×›×ª×•×‘×ª ×”×•×¢×ª×§×” ×œ×œ×•×—!');
            });
        }
        
        function testManifest() {
            window.open('https://localhost:3001/manifest.xml', '_blank');
        }
        
        function openTroubleshooting() {
            window.open('OUTLOOK_CONNECTION_GUIDE.md', '_blank');
        }
        
        function openTestInterface() {
            window.open('email-test-interface.html', '_blank');
        }
        
        // ×‘×“×™×§×” ××•×˜×•××˜×™×ª ×‘×˜×¢×™× ×ª ×”×“×£
        window.onload = function() {
            setTimeout(checkStatus, 1000);
        };
    </script>
</body>
</html>
