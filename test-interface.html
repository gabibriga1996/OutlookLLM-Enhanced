<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OutlookLLM Enhanced - Test Page</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0078d4;
            margin-bottom: 20px;
        }
        .button {
            background-color: #0078d4;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
            font-size: 16px;
        }
        .button:hover {
            background-color: #106ebe;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 4px;
            background-color: #f0f8ff;
            border: 1px solid #0078d4;
        }
        .response {
            margin: 20px 0;
            padding: 15px;
            border-radius: 4px;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
        }
        textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: Arial, sans-serif;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ OutlookLLM Enhanced - Test Interface</h1>
        
        <div class="status" id="status">
            ××¦×‘: ×˜×•×¢×Ÿ...
        </div>

        <h2>âœï¸ ×‘×“×™×§×ª ×™×¦×™×¨×ª ××™××™×™×œ</h2>
        <textarea id="emailPrompt" placeholder="×”×›× ×¡ ×›××Ÿ ××ª ×”×”× ×—×™×” ×œ×™×¦×™×¨×ª ××™××™×™×œ...">×›×ª×•×‘ ×œ×™ ××™××™×™×œ ××§×¦×•×¢×™ ×œ×‘×§×©×ª ×¤×’×™×©×”</textarea>
        <button class="button" onclick="testComposeEmail()">×¦×•×¨ ××™××™×™×œ</button>

        <h2>ğŸ“„ ×‘×“×™×§×ª ×¡×™×›×•× ××™××™×™×œ</h2>
        <textarea id="emailContent" placeholder="×”×›× ×¡ ×›××Ÿ ×ª×•×›×Ÿ ××™××™×™×œ ×œ×¡×™×›×•×...">×©×œ×•×, ×× ×™ ×¨×•×¦×” ×œ×§×‘×•×¢ ×¤×’×™×©×” ×œ×“×•×Ÿ ×¢×œ ×”×¤×¨×•×™×§×˜ ×”×—×“×© ×©×œ× ×•. ×”×× ××ª×” ×–××™×Ÿ ××—×¨ ×‘×©×¢×” 14:00? ×ª×•×“×” ×¨×‘×”.</textarea>
        <button class="button" onclick="testSummarizeEmail()">×¡×›× ××™××™×™×œ</button>

        <h2>ğŸ“§ ×‘×“×™×§×ª ×¡×™×›×•× ××™×™×œ×™× ×©×œ× × ×§×¨××•</h2>
        <p>×‘×“×™×§×” ×¢× ××™×™×œ×™× ××“×•××™× (×”×¤×•× ×§×¦×™×” ×”×××™×ª×™×ª ×ª×¢×‘×•×“ ×¨×§ ×‘×ª×•×š Outlook)</p>
        <button class="button" onclick="testSummarizeUnreadEmails()">×¡×›× ××™×™×œ×™× ×©×œ× × ×§×¨××•</button>

        <div class="response" id="response">
            ×”×ª×’×•×‘×•×ª ×™×•×¤×™×¢×• ×›××Ÿ...
        </div>

        <h2>ğŸ”§ ×‘×“×™×§×ª ×—×™×‘×•×¨ ×œ×©×¨×ª</h2>
        <button class="button" onclick="testConnection()">×‘×“×•×§ ×—×™×‘×•×¨</button>
    </div>

    <script>
        function updateStatus(message) {
            document.getElementById('status').innerHTML = message;
        }

        function showResponse(data) {
            document.getElementById('response').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
        }

        async function testConnection() {
            try {
                updateStatus('×‘×•×“×§ ×—×™×‘×•×¨ ×œ×©×¨×ª...');
                const response = await fetch('http://127.0.0.1:8385/health');
                const data = await response.json();
                updateStatus('âœ… ×”×—×™×‘×•×¨ ×œ×©×¨×ª ×ª×§×™×Ÿ!');
                showResponse(data);
            } catch (error) {
                updateStatus('âŒ ×©×’×™××” ×‘×—×™×‘×•×¨ ×œ×©×¨×ª: ' + error.message);
                showResponse({error: error.message});
            }
        }

        async function testComposeEmail() {
            try {
                updateStatus('×™×•×¦×¨ ××™××™×™×œ...');
                const prompt = document.getElementById('emailPrompt').value;
                const response = await fetch('http://127.0.0.1:8385/composeEmail', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({prompt: prompt})
                });
                const data = await response.json();
                updateStatus('âœ… ××™××™×™×œ × ×•×¦×¨ ×‘×”×¦×œ×—×”!');
                showResponse(data);
            } catch (error) {
                updateStatus('âŒ ×©×’×™××” ×‘×™×¦×™×¨×ª ××™××™×™×œ: ' + error.message);
                showResponse({error: error.message});
            }
        }

        async function testSummarizeEmail() {
            try {
                updateStatus('××¡×›× ××™××™×™×œ...');
                const content = document.getElementById('emailContent').value;
                const response = await fetch('http://127.0.0.1:8385/summarizeEmail', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({content: content})
                });
                const data = await response.json();
                updateStatus('âœ… ××™××™×™×œ ×¡×•×›× ×‘×”×¦×œ×—×”!');
                showResponse(data);
            } catch (error) {
                updateStatus('âŒ ×©×’×™××” ×‘×¡×™×›×•× ××™××™×™×œ: ' + error.message);
                showResponse({error: error.message});
            }
        }

        async function testSummarizeUnreadEmails() {
            try {
                updateStatus('××¡×›× ××™×™×œ×™× ×©×œ× × ×§×¨××•...');
                
                // Mock unread emails for testing
                const mockEmails = [
                    {
                        subject: "×¤×’×™×©×” ×“×—×•×¤×”",
                        sender: "×× ×”×œ ×”×¤×¨×•×™×§×˜",
                        body: "×©×œ×•×, ×× ×™ ×¦×¨×™×š ×œ×§×‘×•×¢ ×¤×’×™×©×” ×“×—×•×¤×” ×œ×“×•×Ÿ ×¢×œ ×”×©×™× ×•×™×™× ×‘×¤×¨×•×™×§×˜. ××¤×©×¨ ××—×¨ ×‘×‘×•×§×¨?",
                        dateReceived: "2025-09-14T10:30:00Z"
                    },
                    {
                        subject: "×¢×“×›×•×Ÿ ××¢×¨×›×ª",
                        sender: "××—×œ×§×ª IT",
                        body: "×”×¢×“×›×•×Ÿ ×”×—×“×© ×©×œ ×”××¢×¨×›×ª ×™×ª×‘×¦×¢ ×”×¢×¨×‘ ×‘×©×¢×” 22:00. × × ×œ×”×›×™×Ÿ ×’×™×‘×•×™ ×œ×›×œ ×”×§×‘×¦×™×.",
                        dateReceived: "2025-09-14T09:15:00Z"
                    },
                    {
                        subject: "×”×–×× ×” ×œ××™×¨×•×¢",
                        sender: "××©××‘×™ ×× ×•×©",
                        body: "××ª× ××•×–×× ×™× ×œ××™×¨×•×¢ ×”×—×‘×¨×” ×”×©× ×ª×™ ×‘×™×•× ×©×™×©×™. × × ×œ××©×¨ ×”×’×¢×” ×¢×“ ×™×•× ×¨×‘×™×¢×™.",
                        dateReceived: "2025-09-14T08:00:00Z"
                    }
                ];

                const response = await fetch('http://127.0.0.1:8385/summarizeUnreadEmails', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({emails: mockEmails})
                });
                const data = await response.json();
                updateStatus('âœ… ××™×™×œ×™× ×©×œ× × ×§×¨××• ×¡×•×›××• ×‘×”×¦×œ×—×”!');
                showResponse(data);
            } catch (error) {
                updateStatus('âŒ ×©×’×™××” ×‘×¡×™×›×•× ××™×™×œ×™× ×©×œ× × ×§×¨××•: ' + error.message);
                showResponse({error: error.message});
            }
        }
        window.onload = function() {
            updateStatus('ğŸš€ OutlookLLM Enhanced ××•×›×Ÿ ×œ×©×™××•×©!');
            testConnection();
        };
    </script>
</body>
</html>
